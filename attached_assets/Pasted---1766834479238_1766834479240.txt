–î–ï–¢–ê–õ–¨–ù–ò–ô –ü–†–ò–ù–¶–ò–ü –†–û–ë–û–¢–ò –ü–ê–†–°–ò–ù–ì–£ –¢–ê –†–û–ó–°–ò–õ–û–ö –î–õ–Ø –ö–Ü–ë–ï–†–ü–û–õ–Ü–¶–Ü–á

üìä –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–ò

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ö–Ü–ë–ï–†–ü–û–õ–Ü–¶–Ü–Ø - –°–ò–°–¢–ï–ú–ê –ê–ù–ê–õ–Ü–ó–£ –¢–ê –†–û–ó–°–ò–õ–û–ö            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  LAYER 1: –ü–ê–†–°–ò–ù–ì / OSINT                  LAYER 2: –†–û–ó–°–ò–õ–ö–ò             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
‚îÇ  ‚îÇ   –ó–±—ñ—Ä –¥–∞–Ω–∏—Ö‚îÇ  ‚îÇ   –ê–Ω–∞–ª—ñ–∑    ‚îÇ          ‚îÇ –ö–∞–º–ø–∞–Ω—ñ—ó    ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ –ß–∞—Ç–∏    ‚îÇ  ‚îÇ   ‚Ä¢ AI      ‚îÇ          ‚îÇ ‚Ä¢ –®–∞–±–ª–æ–Ω–∏   ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ –Æ–∑–µ—Ä–∏   ‚îÇ  ‚îÇ   ‚Ä¢ –ü–∞—Ç–µ—Ä–Ω–∏ ‚îÇ          ‚îÇ ‚Ä¢ –†–æ–∑–∫–ª–∞–¥   ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ –ü–æ—Å—Ç–∏   ‚îÇ  ‚îÇ   ‚Ä¢ –ì—Ä–∞—Ñ–∏   ‚îÇ          ‚îÇ ‚Ä¢ –°–µ–≥–º–µ–Ω—Ç–∏  ‚îÇ               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ        ‚îÇ                    ‚îÇ                       ‚îÇ                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                            –ë–ê–ó–ê –î–ê–ù–ò–•                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  –¢–∞–±–ª–∏—Ü—ñ: chats, users, messages, campaigns, results, analytics    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  –Ü–Ω–¥–µ–∫—Å–∏: –ø–æ —á–∞—Ç–∞—Ö, —é–∑–µ—Ä–∞—Ö, –¥–∞—Ç–∞—Ö, –∫–ª—é—á–æ–≤–∏—Ö —Å–ª–æ–≤–∞—Ö                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ        ‚îÇ                    ‚îÇ                       ‚îÇ                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                     –ö–û–ú–£–ù–Ü–ö–ê–¶–Ü–ô–ù–ò–ô –®–ê–† (Telethon/API)                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  –ë–æ—Ç–∏: 1..N —Å–µ—Å—ñ–π –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø—Ä–æ–∫—Å—ñ —Ç–∞ device fingerprints          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  –û–±–º–µ–∂–µ–Ω–Ω—è: FloodWait –æ–±—Ä–æ–±–∫–∞, –æ–±—Ö—ñ–¥ –ª—ñ–º—ñ—Ç—ñ–≤, –ø–∞—É–∑–∏                ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

üîç –î–ï–¢–ê–õ–¨–ù–ò–ô –ü–ê–†–°–ò–ù–ì (OSINT / –†–û–ó–í–Ü–î–ö–ê)

1. –ö–û–ú–ü–õ–ï–ö–°–ù–ò–ô –ü–ê–†–°–ï–† –î–ê–ù–ò–•

```python
# parsers/advanced_parser.py
import asyncio
import re
import json
from datetime import datetime, timedelta
from typing import Dict, List, Optional
from dataclasses import dataclass
from collections import defaultdict

from telethon import TelegramClient
from telethon.tl.functions.messages import GetHistoryRequest, SearchRequest
from telethon.tl.types import (
    PeerChannel, PeerChat, PeerUser,
    Channel, Chat, User,
    Message, MessageMediaPhoto, MessageMediaDocument
)

@dataclass
class ParsedMessage:
    """–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–æ–∑—ñ–±—Ä–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å"""
    id: int
    date: datetime
    sender_id: int
    sender_username: Optional[str]
    text: str
    media_type: Optional[str]
    views: int
    forwards: int
    replies: Optional[int]
    edit_date: Optional[datetime]
    contains_coordinates: bool = False
    contains_keywords: List[str] = None
    threat_level: int = 0

class AdvancedTelegramParser:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø–∞—Ä—Å–µ—Ä Telegram –¥–∞–Ω–∏—Ö"""
    
    def __init__(self, client: TelegramClient):
        self.client = client
        self.parsed_data = {
            'chats': {},
            'users': {},
            'messages': [],
            'statistics': defaultdict(int)
        }
        
        # –ü–∞—Ç–µ—Ä–Ω–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
        self.patterns = {
            'coordinates': [
                r'\b(\d{2}\.\d{4,6}),\s*(\d{2,3}\.\d{4,6})\b',
                r'\b(\d{2})¬∞(\d{2})\'(\d{2})"[NS]\s*(\d{2})¬∞(\d{2})\'(\d{2})"[EW]\b',
                r'\b[A-R]{2}\d{2}[a-x]{2}\b',  # Military grid
            ],
            'phone_numbers': r'[\+\(]?[1-9][0-9\-\(\)\.]{8,}\d',
            'crypto_wallets': r'\b(0x[a-fA-F0-9]{40}|[13][a-km-zA-HJ-NP-Z1-9]{25,34})\b',
            'explosives': ['—Ç–Ω—Ç', '–¥–∏–Ω–∞–º—ñ—Ç', '–¥–µ—Ç–æ–Ω–∞—Ç–æ—Ä', '–∑–∞–ø–∞–ª', '–≤–∏–±—É—Ö—ñ–≤–∫–∞', '–ø–æ—Ä–æ—Ö'],
            'weapons': ['–∞–≤—Ç–æ–º–∞—Ç', '–≥—Ä–∞–Ω–∞—Ç–æ–º–µ—Ç', '—Å–Ω–∞–π–ø–µ—Ä', '—Äpg', '—Ç–∞–Ω–∫', '–±—Ç—Ä'],
            'military_terms': ['–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏', '–∞–∑–∏–º—É—Ç', '–∑—Å—É', '—Ä—Ñ', '—Ä–æ—Ç–∞', '–≤–∑–≤–æ–¥']
        }
    
    async def parse_chat_deep(self, chat_identifier, limit: int = 5000) -> Dict:
        """–ì–ª–∏–±–æ–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ —á–∞—Ç—É –∑ –ø–æ–≤–Ω–∏–º –∞–Ω–∞–ª—ñ–∑–æ–º"""
        try:
            entity = await self.client.get_entity(chat_identifier)
            
            chat_data = {
                'id': entity.id,
                'title': getattr(entity, 'title', 'Unknown'),
                'username': getattr(entity, 'username', None),
                'participants_count': getattr(entity, 'participants_count', 0),
                'date_created': getattr(entity, 'date', None),
                'scam': getattr(entity, 'scam', False),
                'verified': getattr(entity, 'verified', False),
                'access_hash': entity.access_hash if hasattr(entity, 'access_hash') else None
            }
            
            # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —á–∞—Ç
            self.parsed_data['chats'][entity.id] = chat_data
            
            # –ü–∞—Ä—Å–∏–Ω–≥ —É—á–∞—Å–Ω–∏–∫—ñ–≤
            participants = await self.parse_participants(entity, limit=200)
            
            # –ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
            messages = await self.parse_messages(entity, limit=limit)
            
            # –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ–∞ –≤–∑–∞—î–º–æ–¥—ñ–π
            interaction_graph = self.build_interaction_graph(messages, participants)
            
            # –ê–Ω–∞–ª—ñ–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
            activity_analysis = self.analyze_activity(messages)
            
            # –í–∏—è–≤–ª–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –æ—Å—ñ–±
            key_persons = self.identify_key_persons(interaction_graph, messages)
            
            return {
                'chat_info': chat_data,
                'participants_count': len(participants),
                'messages_count': len(messages),
                'time_range': self.get_time_range(messages),
                'activity_analysis': activity_analysis,
                'key_persons': key_persons,
                'interaction_graph': interaction_graph,
                'threat_assessment': self.assess_threat_level(messages, participants)
            }
            
        except Exception as e:
            print(f"–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É —á–∞—Ç—É {chat_identifier}: {e}")
            return {}
    
    async def parse_participants(self, entity, limit: int = 200) -> List[Dict]:
        """–ü–∞—Ä—Å–∏–Ω–≥ —É—á–∞—Å–Ω–∏–∫—ñ–≤ —á–∞—Ç—É –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é"""
        participants_data = []
        
        try:
            participants = await self.client.get_participants(entity, limit=limit, aggressive=True)
            
            for user in participants:
                user_data = {
                    'id': user.id,
                    'username': user.username,
                    'first_name': user.first_name,
                    'last_name': user.last_name,
                    'phone': user.phone,
                    'bot': user.bot,
                    'verified': user.verified,
                    'scam': user.scam,
                    'fake': user.fake,
                    'restricted': user.restricted,
                    'status': str(user.status),
                    'last_seen': self.parse_last_seen(user.status),
                    'photo': bool(user.photo),
                    'premium': getattr(user, 'premium', False),
                    'risk_score': self.calculate_user_risk_score(user)
                }
                
                participants_data.append(user_data)
                
                # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –≥–ª–æ–±–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ
                self.parsed_data['users'][user.id] = user_data
                
            return participants_data
            
        except Exception as e:
            print(f"–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É —É—á–∞—Å–Ω–∏–∫—ñ–≤: {e}")
            return []
    
    async def parse_messages(self, entity, limit: int = 5000) -> List[ParsedMessage]:
        """–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –∞–Ω–∞–ª—ñ–∑–æ–º"""
        messages_data = []
        offset_id = 0
        total_parsed = 0
        
        print(f"üîç –ü–æ—á–∞—Ç–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–ª—ñ–º—ñ—Ç: {limit})...")
        
        while total_parsed < limit:
            try:
                # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ä—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
                history = await self.client(GetHistoryRequest(
                    peer=entity,
                    offset_id=offset_id,
                    offset_date=None,
                    add_offset=0,
                    limit=min(100, limit - total_parsed),
                    max_id=0,
                    min_id=0,
                    hash=0
                ))
                
                if not history.messages:
                    break
                
                # –û–±—Ä–æ–±–∫–∞ –∫–æ–∂–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                for msg in history.messages:
                    parsed_msg = await self.parse_single_message(msg)
                    messages_data.append(parsed_msg)
                    
                    total_parsed += 1
                    
                    # –ü—Ä–æ–≥—Ä–µ—Å –∫–æ–∂–Ω—ñ 100 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
                    if total_parsed % 100 == 0:
                        print(f"üì• –ü–∞—Ä—Å–∏–Ω–≥: {total_parsed}/{limit} –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å")
                
                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è offset –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –ø–æ—Ä—Ü—ñ—ó
                offset_id = history.messages[-1].id
                
                # –Ø–∫—â–æ –æ—Ç—Ä–∏–º–∞–Ω–æ –º–µ–Ω—à–µ –Ω—ñ–∂ –∑–∞–ø–∏—Ç—É–≤–∞–ª–∏ - –∑–Ω–∞—á–∏—Ç—å –±—ñ–ª—å—à–µ –Ω–µ–º–∞—î
                if len(history.messages) < 100:
                    break
                    
                # –ù–µ–≤–µ–ª–∏–∫–∞ –ø–∞—É–∑–∞, —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ API
                await asyncio.sleep(0.5)
                
            except Exception as e:
                print(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å: {e}")
                break
        
        print(f"‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: {len(messages_data)} –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å")
        return messages_data
    
    async def parse_single_message(self, message: Message) -> ParsedMessage:
        """–î–µ—Ç–∞–ª—å–Ω–∏–π –ø–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        # –ë–∞–∑–æ–≤—ñ –¥–∞–Ω—ñ
        parsed = ParsedMessage(
            id=message.id,
            date=message.date,
            sender_id=message.sender_id if hasattr(message, 'sender_id') else 0,
            sender_username=None,
            text=message.message or '',
            media_type=self.get_media_type(message.media) if message.media else None,
            views=message.views or 0,
            forwards=message.forwards or 0,
            replies=message.replies.replies if hasattr(message, 'replies') else 0,
            edit_date=message.edit_date if hasattr(message, 'edit_date') else None
        )
        
        # –ü–æ—à—É–∫ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ —Ç–∞ –ø–∞—Ç–µ—Ä–Ω—ñ–≤
        parsed.contains_keywords = self.find_keywords_in_text(parsed.text)
        parsed.contains_coordinates = self.find_coordinates_in_text(parsed.text)
        
        # –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä—ñ–≤–Ω—è –∑–∞–≥—Ä–æ–∑–∏
        parsed.threat_level = self.calculate_threat_level(parsed)
        
        # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ
        self.update_statistics(parsed)
        
        return parsed
    
    def find_coordinates_in_text(self, text: str) -> bool:
        """–ü–æ—à—É–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —É —Ç–µ–∫—Å—Ç—ñ"""
        for pattern in self.patterns['coordinates']:
            if re.search(pattern, text, re.IGNORECASE):
                return True
        return False
    
    def find_keywords_in_text(self, text: str) -> List[str]:
        """–ü–æ—à—É–∫ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç—ñ"""
        found_keywords = []
        text_lower = text.lower()
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤
        for category, keywords in self.patterns.items():
            if category in ['coordinates', 'phone_numbers', 'crypto_wallets']:
                continue
            
            for keyword in keywords:
                if keyword in text_lower:
                    found_keywords.append(f"{category}:{keyword}")
        
        return found_keywords
    
    def calculate_threat_level(self, message: ParsedMessage) -> int:
        """–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä—ñ–≤–Ω—è –∑–∞–≥—Ä–æ–∑–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        threat_score = 0
        
        # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ +50
        if message.contains_coordinates:
            threat_score += 50
        
        # –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ +10 –∑–∞ –∫–æ–∂–Ω–µ
        if message.contains_keywords:
            threat_score += len(message.contains_keywords) * 10
        
        # –ú–µ–¥—ñ–∞ (–º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ EXIF –¥–∞–Ω—ñ) +20
        if message.media_type:
            threat_score += 20
        
        # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–º–æ–∂–µ –±—É—Ç–∏ —à–∏—Ñ—Ä–æ–º) +15
        if message.edit_date:
            threat_score += 15
        
        # –û–±–º–µ–∂–µ–Ω–Ω—è –¥–æ 100
        return min(threat_score, 100)
    
    def build_interaction_graph(self, messages: List[ParsedMessage], participants: List[Dict]) -> Dict:
        """–ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ–∞ –≤–∑–∞—î–º–æ–¥—ñ–π –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏"""
        graph = {
            'nodes': [],
            'edges': [],
            'centrality': {}
        }
        
        # –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–¥ (—É—á–∞—Å–Ω–∏–∫—ñ–≤)
        for user in participants:
            graph['nodes'].append({
                'id': user['id'],
                'label': user.get('username') or user.get('first_name', str(user['id'])),
                'group': 'participant',
                'risk_score': user.get('risk_score', 0),
                'messages_count': 0,
                'influence': 0
            })
        
        # –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ–π
        user_message_counts = defaultdict(int)
        reply_edges = defaultdict(int)
        
        for msg in messages:
            sender_id = msg.sender_id
            user_message_counts[sender_id] += 1
            
            # –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π (reply_to)
            # —Ç–∞ –ø–µ—Ä–µ—Å–∏–ª–∞–Ω—å (forward_from)
        
        # –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—ñ
        total_messages = len(messages)
        for node in graph['nodes']:
            user_id = node['id']
            msg_count = user_message_counts.get(user_id, 0)
            
            node['messages_count'] = msg_count
            node['influence'] = (msg_count / total_messages * 100) if total_messages > 0 else 0
            
            # Degree centrality (—Å–ø—Ä–æ—â–µ–Ω–æ)
            graph['centrality'][user_id] = node['influence']
        
        return graph
    
    def identify_key_persons(self, graph: Dict, messages: List[ParsedMessage]) -> List[Dict]:
        """–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–ª—é—á–æ–≤–∏—Ö –æ—Å—ñ–± —É —á–∞—Ç—ñ"""
        if not graph['nodes']:
            return []
        
        # –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –≤–ø–ª–∏–≤–æ–≤—ñ—Å—Ç—é
        sorted_nodes = sorted(
            graph['nodes'],
            key=lambda x: x['influence'],
            reverse=True
        )
        
        key_persons = []
        for node in sorted_nodes[:10]:  # –¢–æ–ø-10
            # –ü–æ—à—É–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            user_messages = [m for m in messages if m.sender_id == node['id']]
            
            # –ê–Ω–∞–ª—ñ–∑ –∑–º—ñ—Å—Ç—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
            high_threat_messages = [m for m in user_messages if m.threat_level > 50]
            
            key_persons.append({
                'user_id': node['id'],
                'username': node['label'],
                'influence_score': node['influence'],
                'messages_count': node['messages_count'],
                'high_threat_messages': len(high_threat_messages),
                'average_threat_level': sum(m.threat_level for m in user_messages) / len(user_messages) if user_messages else 0,
                'last_active': max(m.date for m in user_messages).isoformat() if user_messages else None
            })
        
        return key_persons
```

2. –ü–ê–†–°–ò–ù–ì –ó –†–ï–ê–õ–¨–ù–ò–ú –ß–ê–°–û–ú –¢–ê –Ü–ù–ö–†–ï–ú–ï–ù–¢–ê–õ–¨–ù–ò–ú–ò –û–ù–û–í–õ–ï–ù–ù–Ø–ú–ò

```python
# parsers/realtime_parser.py
import asyncio
from datetime import datetime, timedelta
import hashlib

class RealTimeParser:
    """–ü–∞—Ä—Å–∏–Ω–≥ –∑ —Ä–µ–∞–ª—å–Ω–∏–º —á–∞—Å–æ–º —Ç–∞ —ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∏–º–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏"""
    
    def __init__(self, client: TelegramClient):
        self.client = client
        self.last_parsed = {}  # {chat_id: last_message_id}
        self.message_hashes = set()  # –î–ª—è –¥–µ–¥—É–ø–ª—ñ–∫–∞—Ü—ñ—ó
        
    async def start_realtime_monitoring(self, chat_identifiers: List[str]):
        """–ó–∞–ø—É—Å–∫ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ"""
        print(f"üì° –ó–∞–ø—É—Å–∫ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –¥–ª—è {len(chat_identifiers)} —á–∞—Ç—ñ–≤")
        
        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —á–∞—Ç—É
        for chat_id in chat_identifiers:
            try:
                entity = await self.client.get_entity(chat_id)
                
                # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó —Ç–æ—á–∫–∏
                messages = await self.client.get_messages(entity, limit=1)
                if messages:
                    self.last_parsed[entity.id] = messages[0].id
                
                print(f"‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —á–∞—Ç—É {chat_id} –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ")
                
            except Exception as e:
                print(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó {chat_id}: {e}")
        
        # –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª—É –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
        asyncio.create_task(self.monitoring_loop())
    
    async def monitoring_loop(self):
        """–û—Å–Ω–æ–≤–Ω–∏–π —Ü–∏–∫–ª –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É"""
        while True:
            try:
                for chat_id, last_msg_id in list(self.last_parsed.items()):
                    await self.check_new_messages(chat_id, last_msg_id)
                
                # –ü–∞—É–∑–∞ –º—ñ–∂ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏
                await asyncio.sleep(30)  # 30 —Å–µ–∫—É–Ω–¥
                
            except Exception as e:
                print(f"–ü–æ–º–∏–ª–∫–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É: {e}")
                await asyncio.sleep(60)
    
    async def check_new_messages(self, chat_id: int, last_msg_id: int):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥—É"""
        try:
            entity = await self.client.get_input_entity(chat_id)
            
            # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–∑ –∑–∞–ø–∞—Å–æ–º –¥–ª—è –≤–∏–ø–∞–¥–∫—É –≤–∏–¥–∞–ª–µ–Ω–Ω—è)
            messages = await self.client.get_messages(
                entity,
                limit=50,
                offset_id=last_msg_id,
                min_id=last_msg_id
            )
            
            if not messages:
                return
            
            # –û–±—Ä–æ–±–∫–∞ –≤ –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É (–≤—ñ–¥ —Å—Ç–∞—Ä–∏—Ö –¥–æ –Ω–æ–≤–∏—Ö)
            for msg in reversed(messages):
                # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç —á–µ—Ä–µ–∑ —Ö–µ—à
                msg_hash = self.calculate_message_hash(msg)
                
                if msg_hash in self.message_hashes:
                    continue
                
                # –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                parsed = await self.parse_single_message(msg)
                
                # –ê–Ω–∞–ª—ñ–∑ –Ω–∞ –∑–∞–≥—Ä–æ–∑–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
                if parsed.threat_level > 30:
                    await self.trigger_real_time_alert(parsed, chat_id)
                
                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ ID
                self.last_parsed[chat_id] = max(self.last_parsed.get(chat_id, 0), msg.id)
                
                # –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ö–µ—à—É
                self.message_hashes.add(msg_hash)
                
            # –û–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –Ω–∞–±–æ—Ä—É —Ö–µ—à—ñ–≤
            if len(self.message_hashes) > 10000:
                self.message_hashes = set(list(self.message_hashes)[-5000:])
                
        except Exception as e:
            print(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–ª—è {chat_id}: {e}")
    
    def calculate_message_hash(self, message) -> str:
        """–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —É–Ω—ñ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–µ—à—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        content = f"{message.id}-{message.text}-{message.date.timestamp()}"
        return hashlib.md5(content.encode()).hexdigest()
    
    async def trigger_real_time_alert(self, message: ParsedMessage, chat_id: int):
        """–¢—Ä–∏–≥–µ—Ä —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ"""
        alert_data = {
            'timestamp': datetime.now().isoformat(),
            'chat_id': chat_id,
            'message_id': message.id,
            'sender_id': message.sender_id,
            'threat_level': message.threat_level,
            'keywords': message.contains_keywords,
            'has_coordinates': message.contains_coordinates,
            'text_preview': message.text[:200]
        }
        
        print(f"üö® –†–ï–ê–õ–¨–ù–ò–ô –ß–ê–°: –ó–∞–≥—Ä–æ–∑–∞ —Ä—ñ–≤–Ω—è {message.threat_level} –≤ —á–∞—Ç—ñ {chat_id}")
        
        # –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∫—É –≤ Telegram, –∑–∞–ø–∏—Å –≤ –ª–æ–≥, —Ç–æ—â–æ
        # await self.send_alert_to_operators(alert_data)
```

üì® –î–ï–¢–ê–õ–¨–ù–Ü –†–û–ó–°–ò–õ–ö–ò (MASS MESSAGING)

3. –°–ò–°–¢–ï–ú–ê –ö–ï–†–£–í–ê–ù–ù–Ø –ö–ê–ú–ü–ê–ù–Ü–Ø–ú–ò

```python
# campaigns/campaign_manager.py
import asyncio
import json
import random
from datetime import datetime, timedelta
from typing import Dict, List, Optional
from enum import Enum
from dataclasses import dataclass
import pandas as pd

class CampaignStatus(Enum):
    DRAFT = "draft"
    SCHEDULED = "scheduled"
    RUNNING = "running"
    PAUSED = "paused"
    COMPLETED = "completed"
    FAILED = "failed"

@dataclass
class CampaignTarget:
    """–¶—ñ–ª—å –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏"""
    identifier: str  # username, phone, chat_id
    type: str  # user, chat, phone
    data: Dict = None  # –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ

@dataclass
class CampaignMessage:
    """–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏"""
    text: str
    media_path: Optional[str] = None
    parse_mode: str = "html"  # html, markdown, none
    buttons: List[Dict] = None  # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

class AdvancedCampaignManager:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–∞–º–ø–∞–Ω—ñ–π —Ä–æ–∑—Å–∏–ª–∫–∏"""
    
    def __init__(self, botnet_manager):
        self.botnet = botnet_manager
        self.active_campaigns = {}
        self.campaign_history = []
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
        self.realtime_stats = {
            'total_sent': 0,
            'success_rate': 0.0,
            'active_campaigns': 0,
            'bots_utilization': 0.0
        }
        
        # –®–∞–±–ª–æ–Ω–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
        self.message_templates = self.load_templates()
    
    def load_templates(self) -> Dict:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å"""
        return {
            'warning': {
                'name': '–ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è',
                'template': """‚ö†Ô∏è –£–í–ê–ì–ê {name}!

–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º—ñ.
–ú—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è: {location}
–ß–∞—Å: {time}

–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ {action}.

–¶–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è."""
            },
            'disinformation': {
                'name': '–î–µ–∑—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è',
                'template': """üö® –ï–ö–°–¢–†–ï–ù–ï –ü–û–í–Ü–î–û–ú–õ–ï–ù–ù–Ø

{false_information}

–ù–µ –ø–æ—à–∏—Ä—é–π—Ç–µ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.
–ß–∞—Å: {time}"""
            },
            'psychological': {
                'name': '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è',
                'template': """üß† –ü–°–ò–•–û–õ–û–ì–Ü–ß–ù–ò–ô –í–ü–õ–ò–í

{message}

–ü–æ–¥—É–º–∞–π—Ç–µ –ø—Ä–æ {suggestion}.

–í–∞—à–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á—á—è –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –Ω–∞—Å."""
            }
        }
    
    async def create_campaign(self, campaign_data: Dict) -> str:
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–∞–º–ø–∞–Ω—ñ—ó"""
        campaign_id = f"CMP-{datetime.now().strftime('%Y%m%d%H%M%S')}-{random.randint(1000, 9999)}"
        
        campaign = {
            'id': campaign_id,
            'name': campaign_data.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∏'),
            'status': CampaignStatus.DRAFT.value,
            'created_at': datetime.now().isoformat(),
            'created_by': campaign_data.get('creator', 'system'),
            
            # –¶—ñ–ª—ñ
            'targets': self.prepare_targets(campaign_data.get('targets', [])),
            'target_type': campaign_data.get('target_type', 'users'),
            
            # –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            'messages': self.prepare_messages(campaign_data.get('messages', [])),
            'message_strategy': campaign_data.get('strategy', 'sequential'),  # sequential, random, a/b
            
            # –†–æ–∑–∫–ª–∞–¥
            'schedule': {
                'start_time': campaign_data.get('start_time'),
                'end_time': campaign_data.get('end_time'),
                'timezone': campaign_data.get('timezone', 'Europe/Kyiv'),
                'delays': campaign_data.get('delays', {'min': 3, 'max': 10})
            },
            
            # –û–±–º–µ–∂–µ–Ω–Ω—è
            'limits': {
                'messages_per_hour': campaign_data.get('messages_per_hour', 100),
                'messages_per_bot': campaign_data.get('messages_per_bot', 20),
                'retry_attempts': campaign_data.get('retry_attempts', 3)
            },
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            'statistics': {
                'total_targets': 0,
                'processed': 0,
                'successful': 0,
                'failed': 0,
                'started_at': None,
                'completed_at': None
            },
            
            # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            'settings': {
                'personalization': campaign_data.get('personalization', True),
                'tracking': campaign_data.get('tracking', True),
                'stop_on_failure_rate': campaign_data.get('stop_on_failure_rate', 50),
                'auto_pause_on_flood': campaign_data.get('auto_pause_on_flood', True)
            }
        }
        
        # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó
        self.active_campaigns[campaign_id] = campaign
        
        print(f"‚úÖ –ö–∞–º–ø–∞–Ω—ñ—è {campaign_id} —Å—Ç–≤–æ—Ä–µ–Ω–∞: {campaign['name']}")
        
        return campaign_id
    
    def prepare_targets(self, raw_targets: List) -> List[CampaignTarget]:
        """–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ü—ñ–ª–µ–π –¥–ª—è –∫–∞–º–ø–∞–Ω—ñ—ó"""
        prepared_targets = []
        
        for target in raw_targets:
            if isinstance(target, str):
                # –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É
                if target.startswith('@'):
                    target_type = 'username'
                elif target.startswith('+'):
                    target_type = 'phone'
                elif target.isdigit() or (target.startswith('-100') and target[4:].isdigit()):
                    target_type = 'chat_id'
                else:
                    target_type = 'unknown'
                
                prepared_targets.append(CampaignTarget(
                    identifier=target,
                    type=target_type
                ))
            elif isinstance(target, dict):
                prepared_targets.append(CampaignTarget(
                    identifier=target['identifier'],
                    type=target.get('type', 'user'),
                    data=target.get('data', {})
                ))
        
        return prepared_targets
    
    def prepare_messages(self, raw_messages: List) -> List[CampaignMessage]:
        """–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–ª—è –∫–∞–º–ø–∞–Ω—ñ—ó"""
        prepared_messages = []
        
        for msg in raw_messages:
            if isinstance(msg, str):
                # –ü—Ä–æ—Å—Ç–∏–π —Ç–µ–∫—Å—Ç
                prepared_messages.append(CampaignMessage(text=msg))
            elif isinstance(msg, dict):
                # –î–µ—Ç–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                prepared_messages.append(CampaignMessage(
                    text=msg.get('text', ''),
                    media_path=msg.get('media'),
                    parse_mode=msg.get('parse_mode', 'html'),
                    buttons=msg.get('buttons')
                ))
        
        return prepared_messages
    
    async def start_campaign(self, campaign_id: str):
        """–ó–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω—ñ—ó"""
        if campaign_id not in self.active_campaigns:
            raise ValueError(f"–ö–∞–º–ø–∞–Ω—ñ—è {campaign_id} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞")
        
        campaign = self.active_campaigns[campaign_id]
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–∞–ø—É—Å–∫—É
        if not await self.can_start_campaign(campaign):
            print(f"‚ùå –ù–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–∞–º–ø–∞–Ω—ñ—é {campaign_id}")
            return False
        
        # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
        campaign['status'] = CampaignStatus.RUNNING.value
        campaign['statistics']['started_at'] = datetime.now().isoformat()
        campaign['statistics']['total_targets'] = len(campaign['targets'])
        
        print(f"üöÄ –ó–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω—ñ—ó {campaign_id}: {campaign['name']}")
        
        # –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–∞ –∫–∞–º–ø–∞–Ω—ñ—ó
        asyncio.create_task(self.campaign_worker(campaign_id))
        
        return True
    
    async def campaign_worker(self, campaign_id: str):
        """–í–æ—Ä–∫–µ—Ä –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó"""
        campaign = self.active_campaigns[campaign_id]
        
        print(f"üë∑ –í–æ—Ä–∫–µ—Ä –∫–∞–º–ø–∞–Ω—ñ—ó {campaign_id} –∑–∞–ø—É—â–µ–Ω–æ")
        
        # –°—Ç—Ä–∞—Ç–µ–≥—ñ—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
        strategy = campaign['message_strategy']
        
        # –û–±—Ä–æ–±–∫–∞ —Ü—ñ–ª–µ–π
        for i, target in enumerate(campaign['targets']):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –∫–∞–º–ø–∞–Ω—ñ—ó
            if campaign['status'] != CampaignStatus.RUNNING.value:
                print(f"‚è∏Ô∏è –ö–∞–º–ø–∞–Ω—ñ—è {campaign_id} –ø—Ä–∏–∑—É–ø–∏–Ω–µ–Ω–∞")
                break
            
            # –í–∏–±—ñ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—î—é
            message = self.select_message(campaign['messages'], strategy, i)
            
            # –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            personalized_message = self.personalize_message(
                message.text,
                target,
                campaign.get('context', {})
            )
            
            # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è –±–æ—Ç–Ω–µ—Ç–∞
            task = {
                'type': 'send_message',
                'campaign_id': campaign_id,
                'target': target.identifier,
                'target_type': target.type,
                'message': personalized_message,
                'media': message.media_path,
                'parse_mode': message.parse_mode,
                'buttons': message.buttons,
                'priority': 'normal',
                'retry_count': campaign['limits']['retry_attempts']
            }
            
            # –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –≤ —á–µ—Ä–≥—É
            await self.botnet.add_task(task)
            
            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            campaign['statistics']['processed'] += 1
            
            # –í–∏–ø–∞–¥–∫–æ–≤–∞ –∑–∞—Ç—Ä–∏–º–∫–∞
            delay_min = campaign['schedule']['delays']['min']
            delay_max = campaign['schedule']['delays']['max']
            await asyncio.sleep(random.uniform(delay_min, delay_max))
            
            # –ü—Ä–æ–≥—Ä–µ—Å –∫–æ–∂–Ω—ñ 10%
            total = len(campaign['targets'])
            if i > 0 and i % max(1, total // 10) == 0:
                progress = (i / total) * 100
                print(f"üìä –ö–∞–º–ø–∞–Ω—ñ—è {campaign_id}: {progress:.1f}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ")
        
        # –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó
        await self.finish_campaign(campaign_id)
    
    def select_message(self, messages: List[CampaignMessage], strategy: str, index: int) -> CampaignMessage:
        """–í–∏–±—ñ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—î—é"""
        if not messages:
            return CampaignMessage(text="No message")
        
        if strategy == 'sequential':
            # –ü–æ —á–µ—Ä–∑—ñ
            return messages[index % len(messages)]
        elif strategy == 'random':
            # –í–∏–ø–∞–¥–∫–æ–≤–æ
            return random.choice(messages)
        elif strategy == 'weighted':
            # –ó –≤–∞–≥–∞–º–∏ (—è–∫—â–æ —î –≤ –¥–∞–Ω–∏—Ö)
            # –°–ø—Ä–æ—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è
            return messages[index % len(messages)]
        else:
            return messages[0]
    
    def personalize_message(self, template: str, target: CampaignTarget, context: Dict) -> str:
        """–ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        message = template
        
        # –ë–∞–∑–æ–≤—ñ –∑–∞–º—ñ–Ω–Ω–∏–∫–∏
        replacements = {
            '{name}': target.data.get('first_name', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á'),
            '{username}': target.identifier if target.identifier.startswith('@') else '',
            '{phone}': target.identifier if target.identifier.startswith('+') else '',
            '{time}': datetime.now().strftime('%H:%M'),
            '{date}': datetime.now().strftime('%d.%m.%Y'),
            '{location}': context.get('location', '–Ω–µ–≤—ñ–¥–æ–º–æ'),
            '{action}': context.get('action', '–∑–∞–ª–∏—à–∏—Ç–∏ –º—ñ—Å—Ü–µ'),
            '{false_information}': context.get('false_info', '—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞'),
            '{suggestion}': context.get('suggestion', '–≤–∞—à –≤–∏–±—ñ—Ä')
        }
        
        # –ó–∞–º—ñ–Ω–∞
        for placeholder, value in replacements.items():
            if placeholder in message:
                message = message.replace(placeholder, value)
        
        return message
    
    async def finish_campaign(self, campaign_id: str):
        """–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó"""
        campaign = self.active_campaigns[campaign_id]
        
        # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
        success_rate = (campaign['statistics']['successful'] / 
                       campaign['statistics']['processed'] * 100) if campaign['statistics']['processed'] > 0 else 0
        
        if success_rate > 50:
            campaign['status'] = CampaignStatus.COMPLETED.value
            print(f"‚úÖ –ö–∞–º–ø–∞–Ω—ñ—è {campaign_id} —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ({success_rate:.1f}% —É—Å–ø—ñ—Ö—É)")
        else:
            campaign['status'] = CampaignStatus.FAILED.value
            print(f"‚ùå –ö–∞–º–ø–∞–Ω—ñ—è {campaign_id} –ø—Ä–æ–≤–∞–ª–µ–Ω–∞ ({success_rate:.1f}% —É—Å–ø—ñ—Ö—É)")
        
        campaign['statistics']['completed_at'] = datetime.now().isoformat()
        
        # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —ñ—Å—Ç–æ—Ä—ñ—é
        self.campaign_history.append(campaign.copy())
        
        # –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑ –∞–∫—Ç–∏–≤–Ω–∏—Ö (—è–∫—â–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞)
        if campaign['status'] == CampaignStatus.COMPLETED.value:
            del self.active_campaigns[campaign_id]
```

4. –°–ò–°–¢–ï–ú–ê –ü–ï–†–°–û–ù–ê–õ–Ü–ó–ê–¶–Ü–á –¢–ê A/B –¢–ï–°–¢–£–í–ê–ù–ù–Ø

```python
# campaigns/personalization_engine.py
import json
from typing import Dict, List
import random

class PersonalizationEngine:
    """–î–≤–∏–≥—É–Ω –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è"""
    
    def __init__(self):
        self.variants_history = {}
        self.user_profiles = {}
        
    def generate_message_variants(self, base_template: str, num_variants: int = 3) -> List[Dict]:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–ª—è A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è"""
        variants = []
        
        for i in range(num_variants):
            variant = self.create_variant(base_template, i)
            variants.append({
                'id': f"var_{i}",
                'text': variant,
                'style': self.get_variant_style(i),
                'performance': {
                    'impressions': 0,
                    'clicks': 0,
                    'responses': 0,
                    'conversion_rate': 0.0
                }
            })
        
        return variants
    
    def create_variant(self, template: str, variant_id: int) -> str:
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∞—Ä—ñ–∞–Ω—Ç—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        # –†—ñ–∑–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤
        styles = {
            0: {'urgency': 'high', 'formality': 'low', 'length': 'short'},
            1: {'urgency': 'medium', 'formality': 'medium', 'length': 'medium'},
            2: {'urgency': 'low', 'formality': 'high', 'length': 'long'}
        }
        
        style = styles.get(variant_id % 3, styles[0])
        
        # –ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è —à–∞–±–ª–æ–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Å—Ç–∏–ª—é
        modified = template
        
        if style['urgency'] == 'high':
            modified = "üö® –£–í–ê–ì–ê! " + modified
            modified = modified.replace('.', '!')
        
        if style['formality'] == 'high':
            modified = "–®–∞–Ω–æ–≤–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É,\n\n" + modified + "\n\n–ó –ø–æ–≤–∞–≥–æ—é, —Å–∏—Å—Ç–µ–º–∞"
        
        if style['length'] == 'short':
            # –°–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–æ 200 —Å–∏–º–≤–æ–ª—ñ–≤
            if len(modified) > 200:
                modified = modified[:197] + "..."
        
        return modified
    
    def personalize_for_user(self, user_data: Dict, message_template: str) -> str:
        """–ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
        personalized = message_template
        
        # –î–µ–º–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è
        if user_data.get('age'):
            if user_data['age'] < 25:
                personalized = "üëã –ü—Ä–∏–≤—ñ—Ç! " + personalized
            elif user_data['age'] > 50:
                personalized = "–î–æ–±—Ä–æ–≥–æ –¥–Ω—è. " + personalized
        
        # –ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è
        if user_data.get('city'):
            personalized = personalized.replace('{city}', user_data['city'])
        
        # –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é
        if user_data.get('activity_level'):
            if user_data['activity_level'] == 'high':
                personalized = personalized.replace('{urgency}', '—Ç–µ—Ä–º—ñ–Ω–æ–≤–æ')
            else:
                personalized = personalized.replace('{urgency}', '—Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ')
        
        # –î–æ–¥–∞–≤–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ
        if user_data.get('first_name'):
            personalized = personalized.replace('{name}', user_data['first_name'])
        
        return personalized
    
    def select_best_variant(self, campaign_id: str) -> str:
        """–í–∏–±—ñ—Ä –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ –≤–∞—Ä—ñ–∞–Ω—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        if campaign_id not in self.variants_history:
            return None
        
        variants = self.variants_history[campaign_id]
        
        # –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ performance score –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∞—Ä—ñ–∞–Ω—Ç—É
        best_variant = None
        best_score = -1
        
        for variant in variants:
            perf = variant['performance']
            
            if perf['impressions'] < 10:  # –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö
                continue
            
            # –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ score (–º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏)
            score = (
                perf['conversion_rate'] * 50 +
                (perf['responses'] / max(1, perf['impressions'])) * 30 +
                (perf['clicks'] / max(1, perf['impressions'])) * 20
            )
            
            if score > best_score:
                best_score = score
                best_variant = variant['id']
        
        return best_variant
```

5. –°–ö–õ–ê–î–ù–Ü –ê–õ–ì–û–†–ò–¢–ú–ò –†–û–ó–°–ò–õ–û–ö

```python
# campaigns/advanced_strategies.py
import asyncio
from datetime import datetime
import numpy as np
from scipy import stats

class AdvancedMailingStrategies:
    """–°–∫–ª–∞–¥–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ —Ä–æ–∑—Å–∏–ª–æ–∫"""
    
    @staticmethod
    async def smart_timing_strategy(targets: List[Dict], campaign_data: Dict):
        """–†–æ–∑—É–º–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ"""
        scheduled_tasks = []
        
        for target in targets:
            # –ê–Ω–∞–ª—ñ–∑ —ñ—Å—Ç–æ—Ä–∏—á–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            user_activity = target.get('activity_pattern', {})
            
            if user_activity:
                # –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
                optimal_time = AdvancedMailingStrategies.calculate_optimal_time(
                    user_activity,
                    campaign_data.get('urgency', 'medium')
                )
                
                # –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è
                task = {
                    'target': target,
                    'scheduled_time': optimal_time,
                    'priority': 'scheduled'
                }
                scheduled_tasks.append(task)
            else:
                # –í–∏–ø–∞–¥–∫–æ–≤–∏–π —á–∞—Å –≤ —Ä–æ–±–æ—á–∏–π –ø–µ—Ä—ñ–æ–¥
                task = {
                    'target': target,
                    'scheduled_time': AdvancedMailingStrategies.random_business_hours(),
                    'priority': 'normal'
                }
                scheduled_tasks.append(task)
        
        # –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ —á–∞—Å–æ–º
        scheduled_tasks.sort(key=lambda x: x['scheduled_time'])
        
        return scheduled_tasks
    
    @staticmethod
    def calculate_optimal_time(activity_pattern: Dict, urgency: str) -> datetime:
        """–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É –≤—ñ–¥–ø—Ä–∞–≤–∫–∏"""
        now = datetime.now()
        
        # –ê–Ω–∞–ª—ñ–∑ –ø—ñ–∫—ñ–≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
        if 'hourly_activity' in activity_pattern:
            # –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –≥–æ–¥–∏–Ω–∏ –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é
            hourly = activity_pattern['hourly_activity']
            peak_hour = max(hourly.items(), key=lambda x: x[1])[0]
            
            # –ö–æ—Ä–µ–∫—Ü—ñ—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ urgency
            if urgency == 'high':
                # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–µ–≥–∞–π–Ω–æ –∞–±–æ –≤ –Ω–∞–π–±–ª–∏–∂—á–∏–π –ø—ñ–∫
                if hourly.get(now.hour, 0) > 0.3:
                    return now
                else:
                    # –ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—ñ–∫
                    return now.replace(hour=peak_hour, minute=0, second=0)
            elif urgency == 'medium':
                # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø—ñ–∫
                return now.replace(hour=peak_hour, minute=0, second=0)
            else:
                # –í–∏–ø–∞–¥–∫–æ–≤–æ –ø—Ä–æ—Ç—è–≥–æ–º –¥–æ–±–∏
                random_hour = random.randint(9, 18)  # –†–æ–±–æ—á—ñ –≥–æ–¥–∏–Ω–∏
                return now.replace(hour=random_hour, minute=0, second=0)
        
        # –ó–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
        return now.replace(hour=14, minute=0, second=0)  # 14:00
    
    @staticmethod
    def drip_campaign_strategy(targets: List, messages: List, intervals: List[int]):
        """–ö–∞—Å–∫–∞–¥–Ω–∞ (drip) —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è —Ä–æ–∑—Å–∏–ª–∫–∏"""
        drip_sequences = []
        
        for target in targets:
            sequence = []
            current_time = datetime.now()
            
            for i, (message, interval) in enumerate(zip(messages, intervals)):
                step = {
                    'target': target,
                    'message': message,
                    'step_number': i + 1,
                    'scheduled_time': current_time + timedelta(hours=interval),
                    'condition': f"step_{i}_condition"  # –£–º–æ–≤–∞ –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫—Ä–æ–∫—É
                }
                sequence.append(step)
            
            drip_sequences.append({
                'target': target,
                'sequence': sequence,
                'current_step': 0,
                'completed': False
            })
        
        return drip_sequences
    
    @staticmethod
    def adaptive_throttling(success_rate: float, recent_errors: int) -> Dict:
        """–ê–¥–∞–ø—Ç–∏–≤–Ω–µ —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏"""
        base_delay = (3, 7)  # –ú—ñ–Ω, –º–∞–∫—Å –∑–∞—Ç—Ä–∏–º–∫–∞
        
        if success_rate < 30:
            # –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–∫–∏ –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É —É—Å–ø—ñ—Ö—É
            return {
                'min_delay': base_delay[0] * 3,
                'max_delay': base_delay[1] * 3,
                'batch_size': 1,  # –ú–µ–Ω—à—ñ –ø–∞—Ä—Ç—ñ—ó
                'retry_delay': 30  # –ë—ñ–ª—å—à–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ —Å–ø—Ä–æ–±–∞–º–∏
            }
        elif success_rate > 80:
            # –ó–º–µ–Ω—à–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–∫–∏ –ø—Ä–∏ –≤–∏—Å–æ–∫–æ–º—É —É—Å–ø—ñ—Ö—É
            return {
                'min_delay': max(1, base_delay[0] / 2),
                'max_delay': max(2, base_delay[1] / 2),
                'batch_size': 5,  # –ë—ñ–ª—å—à—ñ –ø–∞—Ä—Ç—ñ—ó
                'retry_delay': 5  # –ú–µ–Ω—à–∞ –∑–∞—Ç—Ä–∏–º–∫–∞
            }
        else:
            # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            return {
                'min_delay': base_delay[0],
                'max_delay': base_delay[1],
                'batch_size': 3,
                'retry_delay': 15
            }
```

üéØ –Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø –ü–ê–†–°–ò–ù–ì–£ –¢–ê –†–û–ó–°–ò–õ–û–ö

```python
# integration/osint_mailing_integration.py
class OSINTMailingIntegration:
    """–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º –ø–∞—Ä—Å–∏–Ω–≥—É —Ç–∞ —Ä–æ–∑—Å–∏–ª–æ–∫"""
    
    def __init__(self, parser, campaign_manager):
        self.parser = parser
        self.campaign_manager = campaign_manager
        
    async def intelligence_based_campaign(self, chat_link: str, analysis_config: Dict):
        """–ö–∞–º–ø–∞–Ω—ñ—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–∑–≤—ñ–¥—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö"""
        print(f"üîç –ü–æ—á–∞—Ç–æ–∫ —Ä–æ–∑–≤—ñ–¥—É–≤–∞–ª—å–Ω–æ—ó –∫–∞–º–ø–∞–Ω—ñ—ó –¥–ª—è {chat_link}")
        
        # 1. –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–∏—Ö
        print("üìä –§–∞–∑–∞ 1: –ó–±—ñ—Ä —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö...")
        intelligence_data = await self.parser.parse_chat_deep(chat_link, limit=1000)
        
        if not intelligence_data:
            print("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑—ñ–±—Ä–∞—Ç–∏ –¥–∞–Ω—ñ")
            return None
        
        # 2. –ê–Ω–∞–ª—ñ–∑ —Ç–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ü—ñ–ª–µ–π
        print("üéØ –§–∞–∑–∞ 2: –ê–Ω–∞–ª—ñ–∑ —Ç–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ü—ñ–ª–µ–π...")
        targets = self.identify_targets_from_intelligence(intelligence_data, analysis_config)
        
        # 3. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
        print("‚úçÔ∏è –§–∞–∑–∞ 3: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å...")
        messages = self.generate_targeted_messages(targets, analysis_config.get('message_templates'))
        
        # 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó
        print("üöÄ –§–∞–∑–∞ 4: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞–º–ø–∞–Ω—ñ—ó —Ä–æ–∑—Å–∏–ª–∫–∏...")
        campaign_data = {
            'name': f"–û–ø–µ—Ä–∞—Ü—ñ—è {chat_link}",
            'targets': targets,
            'messages': messages,
            'strategy': analysis_config.get('strategy', 'smart'),
            'creator': 'OSINT System',
            'personalization': True,
            'tracking': True
        }
        
        campaign_id = await self.campaign_manager.create_campaign(campaign_data)
        
        # 5. –ó–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω—ñ—ó
        print("‚ñ∂Ô∏è –§–∞–∑–∞ 5: –ó–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω—ñ—ó...")
        await self.campaign_manager.start_campaign(campaign_id)
        
        return {
            'campaign_id': campaign_id,
            'intelligence_summary': {
                'chat_title': intelligence_data.get('chat_info', {}).get('title'),
                'total_users': len(intelligence_data.get('participants', [])),
                'key_persons': len(intelligence_data.get('key_persons', [])),
                'high_risk_users': self.count_high_risk_users(intelligence_data)
            },
            'campaign_targets': len(targets)
        }
    
    def identify_targets_from_intelligence(self, intelligence_data: Dict, config: Dict) -> List[Dict]:
        """–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ü—ñ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–∑–≤—ñ–¥—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö"""
        targets = []
        
        # –ö—Ä–∏—Ç–µ—Ä—ñ—ó –≤—ñ–¥–±–æ—Ä—É –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
        criteria = config.get('target_criteria', {
            'min_risk_score': 50,
            'min_influence': 20,
            'require_keywords': True,
            'max_targets': 50
        })
        
        # –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–∏ –∑ –≤–∏—Å–æ–∫–∏–º –≤–ø–ª–∏–≤–æ–º
        key_persons = intelligence_data.get('key_persons', [])
        
        for person in key_persons:
            if len(targets) >= criteria['max_targets']:
                break
            
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤
            if (person['influence_score'] >= criteria['min_influence'] and
                person['average_threat_level'] >= criteria['min_risk_score']):
                
                target_data = {
                    'identifier': f"@{person['username']}" if person['username'] else str(person['user_id']),
                    'type': 'username' if person['username'] else 'user_id',
                    'data': {
                        'first_name': person['username'] or 'User',
                        'risk_score': person['average_threat_level'],
                        'influence': person['influence_score'],
                        'last_active': person['last_active']
                    }
                }
                targets.append(target_data)
        
        return targets
    
    def generate_targeted_messages(self, targets: List[Dict], templates: Dict) -> List[Dict]:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ü—ñ–ª—å–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å"""
        messages = []
        
        # –¢–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–∏–∑–∏–∫—É
        for target in targets:
            risk_score = target['data'].get('risk_score', 0)
            
            if risk_score > 70:
                # –í–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫ - –∂–æ—Ä—Å—Ç–∫–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è
                message = {
                    'text': templates.get('high_risk', '–í–∏—Å–æ–∫–æ—Ä–∏–∑–∏–∫–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä–æ–∑–∞ –≤–∏—è–≤–ª–µ–Ω–∞.'),
                    'urgency': 'high'
                }
            elif risk_score > 40:
                # –°–µ—Ä–µ–¥–Ω—ñ–π —Ä–∏–∑–∏–∫ - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                message = {
                    'text': templates.get('medium_risk', '–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–∏–≤–µ—Ä–Ω—É–ª–∞ —É–≤–∞–≥—É.'),
                    'urgency': 'medium'
                }
            else:
                # –ù–∏–∑—å–∫–∏–π —Ä–∏–∑–∏–∫ - —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                message = {
                    'text': templates.get('low_risk', '–ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.'),
                    'urgency': 'low'
                }
            
            messages.append(message)
        
        return messages
```

üìä –ú–û–ù–Ü–¢–û–†–ò–ù–ì –¢–ê –ê–ù–ê–õ–Ü–¢–ò–ö–ê

```python
# analytics/campaign_analytics.py
import pandas as pd
import plotly.graph_objects as go
from datetime import datetime, timedelta

class CampaignAnalytics:
    """–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –∫–∞–º–ø–∞–Ω—ñ–π —Ä–æ–∑—Å–∏–ª–∫–∏"""
    
    def __init__(self):
        self.performance_data = []
        
    def generate_campaign_report(self, campaign_data: Dict, results: List[Dict]) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É –ø–æ –∫–∞–º–ø–∞–Ω—ñ—ó"""
        df = pd.DataFrame(results)
        
        # –û—Å–Ω–æ–≤–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        total = len(df)
        successful = len(df[df['status'] == 'success'])
        failed = total - successful
        success_rate = (successful / total * 100) if total > 0 else 0
        
        # –ß–∞—Å–æ–≤–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞
        df['hour'] = pd.to_datetime(df['timestamp']).dt.hour
        hourly_stats = df.groupby('hour').agg({
            'status': ['count', lambda x: (x == 'success').sum()]
        }).reset_index()
        
        # –ê–Ω–∞–ª—ñ–∑ –ø–æ–º–∏–ª–æ–∫
        error_analysis = df[df['status'] != 'success'].groupby('error_type').size().to_dict()
        
        # –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –±–æ—Ç—ñ–≤
        bot_performance = df.groupby('bot_id').agg({
            'status': ['count', lambda x: (x == 'success').sum()]
        }).reset_index()
        
        report = {
            'summary': {
                'campaign_name': campaign_data.get('name'),
                'total_messages': total,
                'successful': successful,
                'failed': failed,
                'success_rate': success_rate,
                'duration_hours': self.calculate_duration(campaign_data),
                'average_delay_seconds': df['processing_time'].mean() if 'processing_time' in df.columns else 0
            },
            'hourly_analysis': hourly_stats.to_dict('records'),
            'error_analysis': error_analysis,
            'bot_performance': bot_performance.to_dict('records'),
            'recommendations': self.generate_recommendations(df, campaign_data)
        }
        
        # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
        report['visualizations'] = self.generate_visualizations(df)
        
        return report
    
    def generate_visualizations(self, df: pd.DataFrame) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –¥–ª—è –∑–≤—ñ—Ç—É"""
        visualizations = {}
        
        # –ì—Ä–∞—Ñ—ñ–∫ —É—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ –ø–æ –≥–æ–¥–∏–Ω–∞—Ö
        if 'hour' in df.columns and 'status' in df.columns:
            hourly_success = df.groupby('hour')['status'].apply(
                lambda x: (x == 'success').mean() * 100
            ).reset_index()
            
            fig = go.Figure(data=[
                go.Bar(
                    x=hourly_success['hour'],
                    y=hourly_success['status'],
                    name='–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å %'
                )
            ])
            
            fig.update_layout(
                title='–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ –≥–æ–¥–∏–Ω–∞—Ö',
                xaxis_title='–ì–æ–¥–∏–Ω–∞',
                yaxis_title='–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å %'
            )
            
            visualizations['hourly_success'] = fig.to_html()
        
        return visualizations
    
    def generate_recommendations(self, df: pd.DataFrame, campaign_data: Dict) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–Ω–∞–ª—ñ–∑—É"""
        recommendations = []
        
        # –ê–Ω–∞–ª—ñ–∑ —É—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ
        success_rate = (len(df[df['status'] == 'success']) / len(df) * 100) if len(df) > 0 else 0
        
        if success_rate < 30:
            recommendations.append("‚ö° –ù–∏–∑—å–∫–∞ —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ:")
            recommendations.append("  ‚Ä¢ –ó–±—ñ–ª—å—à–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫–∏ –º—ñ–∂ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏")
            recommendations.append("  ‚Ä¢ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–æ—Ç–∏ –∑ –∫—Ä–∞—â–∏–º success rate")
            recommendations.append("  ‚Ä¢ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —è–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤")
        
        elif success_rate > 80:
            recommendations.append("‚úÖ –í–∏—Å–æ–∫–∞ —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å. –ú–æ–∂–Ω–∞:")
            recommendations.append("  ‚Ä¢ –ó–±—ñ–ª—å—à–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å")
            recommendations.append("  ‚Ä¢ –°–∫–æ—Ä–æ—Ç–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫–∏ –º—ñ–∂ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞–º–∏")
            recommendations.append("  ‚Ä¢ –†–æ–∑—à–∏—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ü—ñ–ª–µ–π")
        
        # –ê–Ω–∞–ª—ñ–∑ –ø–æ–º–∏–ª–æ–∫
        if 'error_type' in df.columns:
            common_errors = df['error_type'].value_counts().head(3)
            
            if not common_errors.empty:
                recommendations.append("üîß –ü–æ—à–∏—Ä–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏:")
                for error, count in common_errors.items():
                    recommendations.append(f"  ‚Ä¢ {error}: {count} —Ä–∞–∑—ñ–≤")
        
        return recommendations
```

üöÄ –®–í–ò–î–ö–ï –í–ü–†–û–í–ê–î–ñ–ï–ù–ù–Ø

```python
# quick_deployment.py
async def deploy_osint_mailing_system():
    """–®–≤–∏–¥–∫–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –ø–∞—Ä—Å–∏–Ω–≥—É —Ç–∞ —Ä–æ–∑—Å–∏–ª–æ–∫"""
    print("üöÄ –®–í–ò–î–ö–ï –†–û–ó–ì–û–†–¢–ê–ù–ù–Ø –°–ò–°–¢–ï–ú–ò...")
    
    # 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞
    client = TelegramClient('police_system', API_ID, API_HASH)
    await client.start()
    
    # 2. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∞—Ä—Å–µ—Ä–∞
    parser = AdvancedTelegramParser(client)
    
    # 3. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–æ—Ç–Ω–µ—Ç—É
    botnet = BotnetManager(max_concurrent=10)
    await botnet.initialize()
    
    # 4. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–∞–º–ø–∞–Ω—ñ–π
    campaign_manager = AdvancedCampaignManager(botnet)
    
    # 5. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
    integration = OSINTMailingIntegration(parser, campaign_manager)
    
    print("‚úÖ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –î–û –†–û–ë–û–¢–ò")
    print(f"üìä –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏: –ü–∞—Ä—Å–µ—Ä + –ë–æ—Ç–Ω–µ—Ç ({botnet.active_bots_count} –±–æ—Ç—ñ–≤) + –ö–∞–º–ø–∞–Ω—ñ—ó")
    
    return {
        'parser': parser,
        'botnet': botnet,
        'campaign_manager': campaign_manager,
        'integration': integration,
        'client': client
    }

# –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
async def example_operation():
    """–ü—Ä–∏–∫–ª–∞–¥ –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–ª—è –≤—É–ª. –ê—Ä—Ç–µ–º–∞, 72"""
    system = await deploy_osint_mailing_system()
    
    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –æ–ø–µ—Ä–∞—Ü—ñ—ó
    operation_config = {
        'chat_link': '@artema72_suspect_chat',
        'target_criteria': {
            'min_risk_score': 40,
            'min_influence': 15,
            'max_targets': 20
        },
        'message_templates': {
            'high_risk': "‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–ê –ó–ê–ì–†–û–ó–ê! –í–∞—à—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ {location} –≤—ñ–¥–æ–º—ñ. –ï–≤–∞–∫—É—é–π—Ç–µ—Å—è!",
            'medium_risk': "üîî –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è: –í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –±—ñ–ª—è {location}",
            'low_risk': "üì° –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞ –≤ —Ä–∞–π–æ–Ω—ñ {location}"
        },
        'strategy': 'smart',
        'location': '–≤—É–ª. –ê—Ä—Ç–µ–º–∞, 72, –î–æ–Ω–µ—Ü—å–∫'
    }
    
    # –ó–∞–ø—É—Å–∫ –æ–ø–µ—Ä–∞—Ü—ñ—ó
    results = await system['integration'].intelligence_based_campaign(
        operation_config['chat_link'],
        operation_config
    )
    
    return results
```

---

üìã –ö–õ–Æ–ß–û–í–Ü –ü–ï–†–ï–í–ê–ì–ò –°–ò–°–¢–ï–ú–ò:

–ü–ê–†–°–ò–ù–ì:

1. –ì–ª–∏–±–∏–Ω–∞ –∞–Ω–∞–ª—ñ–∑—É - –Ω–µ –ª–∏—à–µ —Ç–µ–∫—Å—Ç, –∞–ª–µ –π –ø–∞—Ç–µ—Ä–Ω–∏, –∑–≤'—è–∑–∫–∏, –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
2. –†–µ–∞–ª—å–Ω–∏–π —á–∞—Å - –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏
3. –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π –ø–æ—à—É–∫ - –≤–∏—è–≤–ª–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –æ—Å—ñ–±, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –∑–∞–≥—Ä–æ–∑
4. –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å - –æ–±—Ä–æ–±–∫–∞ —Ç–∏—Å—è—á –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ

–†–û–ó–°–ò–õ–ö–ò:

1. –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è - –∫–æ–∂–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–¥–∞–ø—Ç—É—î—Ç—å—Å—è –ø—ñ–¥ —Ü—ñ–ª—å
2. A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏–±—ñ—Ä –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤
3. –†–æ–∑—É–º–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ - –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π —á–∞—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
4. –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö

–Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø:

1. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è - –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –∞–Ω–∞–ª—ñ–∑ ‚Üí —Ü—ñ–ª—å–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞
2. –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ - –¥–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
3. –ë–µ–∑–ø–µ–∫–∞ - –æ–±—Ö—ñ–¥ –æ–±–º–µ–∂–µ–Ω—å, –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫, —Ä–µ–∑–µ—Ä–≤—É–≤–∞–Ω–Ω—è

---

‚è± –ß–ê–° –í–ò–ö–û–ù–ê–ù–ù–Ø –¢–ò–ü–û–í–û–á –û–ü–ï–†–ê–¶–Ü–á:

```
–§–∞–∑–∞ 1: –ü–∞—Ä—Å–∏–Ω–≥ —á–∞—Ç—É (1000 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å)    - 2-3 —Ö–≤–∏–ª–∏–Ω–∏
–§–∞–∑–∞ 2: –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö —Ç–∞ –≤–∏–±—ñ—Ä —Ü—ñ–ª–µ–π        - 30 —Å–µ–∫—É–Ω–¥
–§–∞–∑–∞ 3: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥. - 1 —Ö–≤–∏–ª–∏–Ω–∞
–§–∞–∑–∞ 4: –†–æ–∑—Å–∏–ª–∫–∞ (20 —Ü—ñ–ª–µ–π)                - 5-10 —Ö–≤–∏–ª–∏–Ω
–§–∞–∑–∞ 5: –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤                 - 1 —Ö–≤–∏–ª–∏–Ω–∞
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ó–ê–ì–ê–õ–¨–ù–ò–ô –ß–ê–°: 10-15 —Ö–≤–∏–ª–∏–Ω
```

---

üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á –î–õ–Ø –ë–û–ô–û–í–û–ì–û –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø:

1. –ü–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü—ñ—î—é: –ì–ª–∏–±–æ–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ —Ü—ñ–ª—å–æ–≤–∏—Ö —á–∞—Ç—ñ–≤ (24+ –≥–æ–¥–∏–Ω–∏ –¥–∞–Ω–∏—Ö)
2. –ü—ñ–¥ —á–∞—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó: –†–µ–∞–ª—å–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ + –∞–¥–∞–ø—Ç–∏–≤–Ω—ñ —Ä–æ–∑—Å–∏–ª–∫–∏
3. –ü—ñ—Å–ª—è –æ–ø–µ—Ä–∞—Ü—ñ—ó: –ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ + –∫–æ—Ä–µ–≥—É–≤–∞–Ω–Ω—è —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π
4. –ó–∞–≤–∂–¥–∏: –†–µ–∑–µ—Ä–≤–Ω—ñ –±–æ—Ç–∏ + –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

