# SHADOW SYSTEM v2.0 - –î–µ—Ç–∞–ª—å–Ω–∏–π –ó–≤—ñ—Ç –ø–æ –í–æ—Ä–æ–Ω–∫–∞—Ö

## –û–≥–ª—è–¥ –°–∏—Å—Ç–µ–º–∏ –í–æ—Ä–æ–Ω–æ–∫

**–§—ñ–ª—å—Ç—Ä –î–æ—Å—Ç—É–ø—É:** LEADER | ADMIN
**–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞:** –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–≥–∞—Ç–æ–∫—Ä–æ–∫–æ–≤–∏–º–∏ –≤–æ—Ä–æ–Ω–∫–∞–º–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é –¥–æ —Ä–æ–∑—Å–∏–ª–æ–∫, OSINT —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –¢–∞–±–ª–∏—Ü—è `funnels` (–û—Å–Ω–æ–≤–Ω–∞ –≤–æ—Ä–æ–Ω–∫–∞)
```sql
id: INTEGER (Primary Key)
owner_id: STRING - Telegram ID –≤–ª–∞—Å–Ω–∏–∫–∞
name: STRING - –ù–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏
description: TEXT - –û–ø–∏—Å
funnel_type: STRING - –¢–∏–ø (default: "onboarding")
status: STRING - –°—Ç–∞—Ç—É—Å (draft/active/paused)
steps_count: INTEGER - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫—Ä–æ–∫—ñ–≤
photo_file_id: STRING - ID —Ñ–æ—Ç–æ –≤–æ—Ä–æ–Ω–∫–∏ (nullable)
tariff_info: TEXT - –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–∞—Ä–∏—Ñ (nullable)
welcome_text: TEXT - –í—ñ—Ç–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç (nullable)
button_text: STRING - –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ (default: "–î–∞–ª—ñ")
is_active: BOOLEAN - –ê–∫—Ç–∏–≤–Ω–∞/–Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ (default: True)
views_count: INTEGER - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤
conversions: INTEGER - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Å—ñ–π
created_at: DATETIME - –ß–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
updated_at: DATETIME - –ß–∞—Å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
```

### –¢–∞–±–ª–∏—Ü—è `funnel_steps` (–ö—Ä–æ–∫–∏ –≤–æ—Ä–æ–Ω–∫–∏)
```sql
id: INTEGER (Primary Key)
funnel_id: INTEGER - ID –≤–æ—Ä–æ–Ω–∫–∏
step_order: INTEGER - –ü–æ—Ä—è–¥–æ–∫ –∫—Ä–æ–∫—É (1, 2, 3...)
title: STRING - –ù–∞–∑–≤–∞ –∫—Ä–æ–∫—É (nullable)
content: TEXT - –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç/—Ç–µ–∫—Å—Ç
photo_file_id: STRING - ID —Ñ–æ—Ç–æ –¥–ª—è –∫—Ä–æ–∫—É (nullable)
button_text: STRING - –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ (default: "–î–∞–ª—ñ")
action_type: STRING - –¢–∏–ø –¥—ñ—ó (next/trigger/end)
action_data: STRING - –î–∞–Ω—ñ –¥–ª—è –¥—ñ—ó (nullable)
delay_seconds: INTEGER - –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º (default: 0)
created_at: DATETIME - –ß–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
```

---

## üéØ –ì–æ–ª–æ–≤–Ω–µ –ú–µ–Ω—é –í–æ—Ä–æ–Ω–æ–∫

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnels_main`
- **–í—Ö—ñ–¥–Ω–∞ —Ç–æ—á–∫–∞:** –ó –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é —Å–∏—Å—Ç–µ–º–∏

### –ï–∫—Ä–∞–Ω –≥–æ–ª–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é
```
üéØ –ú–ï–ù–ï–î–ñ–ï–† –í–û–†–û–ù–û–ö
–°—Ç–≤–æ—Ä—é–π—Ç–µ —Ç–∞ –∫–µ—Ä—É–π—Ç–µ –≤–æ—Ä–æ–Ω–∫–∞–º–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
‚îú üìÅ –í—Å—å–æ–≥–æ –≤–æ—Ä–æ–Ω–æ–∫: N
‚îú üü¢ –ê–∫—Ç–∏–≤–Ω–∏—Ö: N
‚îú üëÅ –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤: N
‚îî ‚úÖ –ö–æ–Ω–≤–µ—Ä—Å—ñ–π: N

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üéØ –í–ê–®–Ü –í–û–†–û–ù–ö–ò:
```

### –ö–Ω–æ–ø–∫–∏ –≥–æ–ª–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é
| –ö–Ω–æ–ø–∫–∞ | Callback | –î—ñ—è |
|--------|----------|-----|
| üü¢/‚ö™ –ù–∞–∑–≤–∞ (N –∫—Ä–æ–∫—ñ–≤) | `funnel_view_{id}` | –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –¥–µ—Ç–∞–ª–µ–π –≤–æ—Ä–æ–Ω–∫–∏ |
| ‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤–æ—Ä–æ–Ω–∫—É | `funnel_create` | –ü–æ—á–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |
| ‚óÄÔ∏è –ù–∞–∑–∞–¥ | `back_to_menu` | –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è |

---

## ‚ûï –ü–†–û–¶–ï–° –°–¢–í–û–†–ï–ù–ù–Ø –í–û–†–û–ù–ö–ò

### –ï—Ç–∞–ø 1: –ù–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏
- **State:** `FunnelStates.waiting_name`
- **–í—Ö—ñ–¥:** Callback `funnel_create`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –Ω–æ–≤–æ—ó –≤–æ—Ä–æ–Ω–∫–∏"
- **–ü—Ä–∏–∫–ª–∞–¥–∏:** "–û–Ω–±–æ—Ä–¥—ñ–Ω–≥ –Ω–æ–≤–∞—á–∫—ñ–≤", "–ü—Ä–æ–¥–∞–∂ –ø—Ä–µ–º—ñ—É–º"
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è:**
  - –ú—ñ–Ω—ñ–º—É–º 2 —Å–∏–º–≤–æ–ª–∏
  - –ú–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª—ñ–≤
- **–í–∏—Ö—ñ–¥:** –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö + `funnel_view_kb`
- **–ü–æ–º–∏–ª–∫–∞:** ‚ùå –ù–∞–∑–≤–∞ –º–∞—î –±—É—Ç–∏ –≤—ñ–¥ 2 –¥–æ 100 —Å–∏–º–≤–æ–ª—ñ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
```
‚úÖ –í–æ—Ä–æ–Ω–∫—É —Å—Ç–≤–æ—Ä–µ–Ω–æ!

üìÅ {–Ω–∞–∑–≤–∞}
‚îú ID: {id}
‚îú –°—Ç–∞—Ç—É—Å: –ß–µ—Ä–Ω–µ—Ç–∫–∞
‚îî –ö—Ä–æ–∫—ñ–≤: 0

–¢–µ–ø–µ—Ä –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –≤–æ—Ä–æ–Ω–∫—É:
```

---

## üîç –î–ï–¢–ê–õ–Ü –í–û–†–û–ù–ö–ò (–ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏)

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_view_{id}`

### –í–º—ñ—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏
```
üéØ {–ù–ê–ó–í–ê}
{–û–ü–ò–°}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìã –Ü–ù–§–û–†–ú–ê–¶–Ü–Ø:
‚îú üÜî ID: {id}
‚îú üìä –°—Ç–∞—Ç—É—Å: üü¢ –ê–∫—Ç–∏–≤–Ω–∞ / ‚ö™ –ù–µ–∞–∫—Ç–∏–≤–Ω–∞
‚îú üìù –ö—Ä–æ–∫—ñ–≤: N
‚îú üñº –§–æ—Ç–æ: –¢–∞–∫/–ù—ñ
‚îî ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥: –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ / –ù–µ –≤–∫–∞–∑–∞–Ω–æ

üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
‚îú üëÅ –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤: N
‚îú ‚úÖ –ö–æ–Ω–≤–µ—Ä—Å—ñ–π: N
‚îî üìä CR: N%

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

‚öôÔ∏è –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø:
```

### –ö–Ω–æ–ø–∫–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–µ—Ç–∞–ª–µ–π
| –†—è–¥–æ–∫ | –ö–Ω–æ–ø–∫–∞ | Callback | –§—É–Ω–∫—Ü—ñ—è |
|------|--------|----------|---------|
| 1 | ‚úèÔ∏è –ù–∞–∑–≤–∞ | `funnel_edit_name_{id}` | –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –Ω–∞–∑–≤—É |
| 1 | üìù –û–ø–∏—Å | `funnel_edit_desc_{id}` | –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –æ–ø–∏—Å |
| 1 | üñº –§–æ—Ç–æ | `funnel_edit_photo_{id}` | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ |
| 2 | üìã –ö—Ä–æ–∫–∏ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_steps_{id}` | –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫—Ä–æ–∫–∞–º–∏ |
| 3 | üìù –®–∞–±–ª–æ–Ω–∏ | `funnel_templates_{id}` | –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —à–∞–±–ª–æ–Ω–∞–º–∏ |
| 3 | üìÖ –ü–ª–∞–Ω | `funnel_schedule_{id}` | –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑—Å–∏–ª–æ–∫ |
| 3 | ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥ | `funnel_edit_config_{id}` | –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è |
| 4 | üìß –†–æ–∑—Å–∏–ª–∫–∞ | `funnel_mailing:{id}:menu` | –ú–µ–Ω—é —Ä–æ–∑—Å–∏–ª–∫–∏ |
| 4 | üîç OSINT | `funnel_osint:{id}:menu` | OSINT –∞–Ω–∞–ª—ñ–∑ |
| 4 | üì° –ú–æ–Ω—ñ—Ç–æ—Ä | `funnel_monitor:{id}:menu` | –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ |
| 5 | ‚è∏/‚ñ∂Ô∏è –°—Ç–æ–ø/–°—Ç–∞—Ä—Ç | `funnel_toggle_{id}` | –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏/–¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ |
| 5 | üìä –°—Ç–∞—Ç–∏ | `funnel_stats_{id}` | –î–µ—Ç–∞–ª–µ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| 5 | üóë –í–∏–¥–∞–ª–∏—Ç–∏ | `funnel_delete_{id}` | –í–∏–¥–∞–ª–µ–Ω–Ω—è |
| 6 | ‚óÄÔ∏è –ù–∞–∑–∞–¥ | `funnels_main` | –ù–∞ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é |

---

## ‚úèÔ∏è –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –í–û–†–û–ù–ö–ò

### 1Ô∏è‚É£ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ù–∞–∑–≤–∏
- **Callback –≤—Ö—ñ–¥:** `funnel_edit_name_{id}`
- **State:** `FunnelStates.editing_name`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É –≤–æ—Ä–æ–Ω–∫–∏"
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è:** 2-100 —Å–∏–º–≤–æ–ª—ñ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ù–∞–∑–≤—É –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞: **{–Ω–æ–≤–∞ –Ω–∞–∑–≤–∞}**
- **–ü–æ–º–∏–ª–∫–∞:** ‚ùå –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É

### 2Ô∏è‚É£ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –û–ø–∏—Å—É
- **Callback –≤—Ö—ñ–¥:** `funnel_edit_desc_{id}`
- **State:** `FunnelStates.editing_description`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å –æ–ø–∏—Å –≤–æ—Ä–æ–Ω–∫–∏"
- **–í–º—ñ—Å—Ç:**ÁÑ°–æ–±–º–µ–∂–µ–Ω–∏–π —Ç–µ–∫—Å—Ç
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û–ø–∏—Å –∑–±–µ—Ä–µ–∂–µ–Ω–æ!

### 3Ô∏è‚É£ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –§–æ—Ç–æ
- **Callback –≤—Ö—ñ–¥:** `funnel_edit_photo_{id}`
- **State:** `FunnelStates.editing_photo`
- **–ó–∞–ø–∏—Ç:** "–ù–∞–¥—ñ—à–ª—ñ—Ç—å –Ω–æ–≤–µ —Ñ–æ—Ç–æ –¥–ª—è –≤–æ—Ä–æ–Ω–∫–∏"
- **–ö–Ω–æ–ø–∫–∏:**
  - üóë –í–∏–¥–∞–ª–∏—Ç–∏ —Ñ–æ—Ç–æ ‚Üí `funnel_remove_photo_{id}`
  - ‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏ ‚Üí `funnel_view_{id}`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –§–æ—Ç–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!
- **–ü–æ–º–∏–ª–∫–∞:** ‚ùå –ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ñ–æ—Ç–æ

### 4Ô∏è‚É£ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- **Callback –≤—Ö—ñ–¥:** `funnel_edit_config_{id}`
- **State:** `FunnelStates.editing_tariff`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è —Ü—ñ—î—ó –≤–æ—Ä–æ–Ω–∫–∏"
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∑–±–µ—Ä–µ–∂–µ–Ω–æ!

---

## üìã –£–ü–†–ê–í–õ–Ü–ù–ù–Ø –ö–†–û–ö–ê–ú–ò –í–û–†–û–ù–ö–ò

### –°–ø–∏—Å–æ–∫ –∫—Ä–æ–∫—ñ–≤
- **Callback –≤—Ö—ñ–¥:** `funnel_steps_{id}`
- **–í–º—ñ—Å—Ç:** –ü–µ—Ä–µ–ª—ñ–∫ —É—Å—ñ—Ö –∫—Ä–æ–∫—ñ–≤ –≤–æ—Ä–æ–Ω–∫–∏ –∑ —ñ–∫–æ–Ω–∫–∞–º–∏

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—Ä–æ–∫—ñ–≤
```
üìã –ö–†–û–ö–ò –í–û–†–û–ù–ö–ò
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìù –í—Å—å–æ–≥–æ –∫—Ä–æ–∫—ñ–≤: N

–í–∏–±–µ—Ä—ñ—Ç—å –∫—Ä–æ–∫ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è:
```

### –ö–Ω–æ–ø–∫–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∫—Ä–æ–∫—ñ–≤
| –ö–Ω–æ–ø–∫–∞ | Callback | –î—ñ—è |
|--------|----------|-----|
| 1. üñº/üìù {–Ω–∞–∑–≤–∞}... | `step_view_{step_id}` | –ü–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –∫—Ä–æ–∫ |
| ... | ... | ... |
| ‚ûï –î–æ–¥–∞—Ç–∏ –∫—Ä–æ–∫ | `step_add_{id}` | –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –∫—Ä–æ–∫ |
| ‚óÄÔ∏è –î–æ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_view_{id}` | –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è |

---

## ‚ûï –î–û–î–ê–í–ê–ù–ù–Ø –ö–†–û–ö–£

### –ï—Ç–∞–ø 1: –í–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –∫—Ä–æ–∫—É
- **Callback –≤—Ö—ñ–¥:** `step_add_{funnel_id}`
- **State:** `FunnelStates.waiting_step_content`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è —Ü—å–æ–≥–æ –∫—Ä–æ–∫—É –≤–æ—Ä–æ–Ω–∫–∏"
- **–§–æ—Ä–º–∞—Ç:** HTML —Ç–µ–≥–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ (<b>, <i>, <code>)
- **–ö–Ω–æ–ø–∫–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è:** ‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏ ‚Üí `funnel_steps_{id}`

### –ï—Ç–∞–ø 2: –í–≤–µ–¥–µ–Ω–Ω—è –Ω–∞–∑–≤–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- **State:** `FunnelStates.waiting_step_title`
- **–ó–∞–ø–∏—Ç:** "–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫—Ä–æ–∫—É (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)"
- **–ö–Ω–æ–ø–∫–∏:**
  - ‚úèÔ∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ ‚Üí –ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ñ–æ—Ç–æ
  - ‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏

### –ï—Ç–∞–ø 3: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- **State:** `FunnelStates.waiting_step_photo`
- **–ó–∞–ø–∏—Ç:** "–ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ñ–æ—Ç–æ –¥–ª—è —Ü—å–æ–≥–æ –∫—Ä–æ–∫—É (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)"
- **–ö–Ω–æ–ø–∫–∏:**
  - ‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è
  - ‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫—Ä–æ–∫—É
```
‚úÖ –ö—Ä–æ–∫ —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω!

–ö—Ä–æ–∫ #N
‚îú –¢–µ–∫—Å—Ç: {–ø–µ—Ä—à—ñ 50 —Å–∏–º–≤–æ–ª—ñ–≤}...
‚îú –ù–∞–∑–≤–∞: {–Ω–∞–∑–≤–∞ / –ù–µ –∑–∞–¥–∞–Ω–æ}
‚îî –§–æ—Ç–æ: {'–¢–∞–∫' / '–ù—ñ'}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

[–ú–µ–Ω—é —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫—Ä–æ–∫–∞–º–∏]
```

---

## üëÅÔ∏è –ü–ï–†–ï–ì–õ–Ø–î–ê–ù–ù–Ø –ö–†–û–ö–£

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `step_view_{step_id}`
- **–í–º—ñ—Å—Ç:**
```
üìù –ö–†–û–ö #{–Ω–æ–º–µ—Ä}
–í–æ—Ä–æ–Ω–∫–∞: {–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

<–¢–ï–ö–°–¢ –ö–†–û–ö–£>

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìã –Ü–ù–§–û–†–ú–ê–¶–Ü–Ø:
‚îú üìù –ù–∞–∑–≤–∞: {–Ω–∞–∑–≤–∞ / –ù–µ –∑–∞–¥–∞–Ω–æ}
‚îú üñº –§–æ—Ç–æ: {'–¢–∞–∫' / '–ù—ñ'}
‚îú ‚è± –ó–∞—Ç—Ä–∏–º–∫–∞: {–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥} —Å–µ–∫
‚îî üéØ –î—ñ—è: {action_type}
```

### –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥–∞–Ω–Ω—è –∫—Ä–æ–∫—É
| –ö–Ω–æ–ø–∫–∞ | Callback | –î—ñ—è |
|--------|----------|-----|
| ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ | `step_edit_content_{id}` | –ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–∫—Å—Ç |
| üìù –ù–∞–∑–≤–∞ | `step_edit_title_{id}` | –ó–º—ñ–Ω–∏—Ç–∏ –Ω–∞–∑–≤—É |
| üñº –§–æ—Ç–æ | `step_edit_photo_{id}` | –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ |
| ‚è± –ó–∞—Ç—Ä–∏–º–∫–∞ | `step_edit_delay_{id}` | –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫—É |
| ‚¨ÜÔ∏è –í–≤–µ—Ä—Ö | `step_move_up_{id}` | –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤–≤–µ—Ä—Ö |
| ‚¨áÔ∏è –í–Ω–∏–∑ | `step_move_down_{id}` | –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤–Ω–∏–∑ |
| üóë –í–∏–¥–∞–ª–∏—Ç–∏ | `step_delete_{id}` | –í–∏–¥–∞–ª–µ–Ω–Ω—è –∫—Ä–æ–∫—É |
| ‚óÄÔ∏è –ù–∞–∑–∞–¥ | `funnel_steps_{funnel_id}` | –î–æ —Å–ø–∏—Å–∫—É –∫—Ä–æ–∫—ñ–≤ |

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –í–û–†–û–ù–ö–ò

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_stats_{id}`

### –í–º—ñ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –í–û–†–û–ù–ö–ò
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìà –ú–ï–¢–†–ò–ö–ò:
‚îú üëÅ –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤: N
‚îú ‚úÖ –ö–æ–Ω–≤–µ—Ä—Å—ñ–π: N
‚îú üìä –ö–æ–Ω–≤–µ—Ä—Å—ñ—è: N%
‚îî üìù –ö—Ä–æ–∫—ñ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: N

üìÖ –î–ê–¢–ò:
‚îú üóì –°—Ç–≤–æ—Ä–µ–Ω–æ: DD.MM.YYYY
‚îî ‚úèÔ∏è –û–Ω–æ–≤–ª–µ–Ω–æ: DD.MM.YYYY
```

### –ö–Ω–æ–ø–∫–∏
| –ö–Ω–æ–ø–∫–∞ | Callback |
|--------|----------|
| ‚óÄÔ∏è –î–æ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_view_{id}` |

---

## üìß –Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø –ó –†–û–ó–°–ò–õ–ö–ê–ú–ò

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_mailing:{id}:menu`

### –ú–µ–Ω—é —Ä–æ–∑—Å–∏–ª–æ–∫
```
üìß –ú–ï–ù–Æ –†–û–ó–°–ò–õ–û–ö
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:
‚îú üìß –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ä–æ–∑—Å–∏–ª–∫—É
‚îú üìù –í–∏–±—Ä–∞—Ç–∏ —à–∞–±–ª–æ–Ω
‚îú üë• –í–∏–±—Ä–∞—Ç–∏ –∞—É–¥–∏—Ç–æ—Ä—ñ—é
‚îú üìÖ –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥
‚îî üìä –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å—Ç–∞—Ç—É—Å
```

### –ö–Ω–æ–ø–∫–∏
| –ö–Ω–æ–ø–∫–∞ | Callback | –î—ñ—è |
|--------|----------|-----|
| ‚ûï –ù–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞ | `funnel_mailing:{id}:create` | –ü–æ—á–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è |
| üìã –ê–∫—Ç–∏–≤–Ω—ñ | `funnel_mailing:{id}:active` | –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö |
| üìã –ê—Ä—Ö—ñ–≤ | `funnel_mailing:{id}:archive` | –ó–∞–≤–µ—Ä—à–µ–Ω—ñ —Ä–æ–∑—Å–∏–ª–∫–∏ |
| üìä –ó–≤—ñ—Ç | `funnel_mailing:{id}:report` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| ‚óÄÔ∏è –î–æ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_view_{id}` | –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è |

---

## üîç –Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø –ó OSINT

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_osint:{id}:menu`

### –ú–µ–Ω—é OSINT
```
üîç OSINT –ê–ù–ê–õ–Ü–ó
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–î–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:
‚îú üåê DNS Lookup
‚îú üÜî WHOIS Lookup
‚îú üó∫ GeoIP
‚îú üìß Email Verify
‚îú üë§ –ê–Ω–∞–ª—ñ–∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
‚îî üí¨ –ü–∞—Ä—Å–∏–Ω–≥ —á–∞—Ç—ñ–≤
```

### –ö–Ω–æ–ø–∫–∏
| –ö–Ω–æ–ø–∫–∞ | Callback |
|--------|----------|
| üî¨ DNS | `funnel_osint:{id}:dns` |
| üÜî WHOIS | `funnel_osint:{id}:whois` |
| üó∫ GeoIP | `funnel_osint:{id}:geoip` |
| üìß Email | `funnel_osint:{id}:email` |
| üë• –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ | `funnel_osint:{id}:users` |
| üí¨ –ß–∞—Ç–∏ | `funnel_osint:{id}:chats` |
| üìä –ó–≤—ñ—Ç | `funnel_osint:{id}:report` |
| ‚óÄÔ∏è –î–æ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_view_{id}` |

---

## üì° –ú–û–ù–Ü–¢–û–†–ò–ù–ì –í–û–†–û–ù–ö–ò

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_monitor:{id}:menu`

### –ú–µ–Ω—é –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
```
üì° –ú–û–ù–Ü–¢–û–†–ò–ù–ì –í–û–†–û–ù–ö–ò
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É:
‚îú üîç –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ–∞–∫—Ü—ñ–π –Ω–∞ –∫—Ä–æ–∫–∏
‚îú üë• –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
‚îú üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Ç—Ä–∏–≥–µ—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—É
‚îî üìä –ó–≤—ñ—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
```

### –ö–Ω–æ–ø–∫–∏ –≥–æ–ª–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
| –ö–Ω–æ–ø–∫–∞ | Callback |
|--------|----------|
| üîç –†–µ–∞–∫—Ü—ñ—ó | `funnel_monitor:{id}:reactions` |
| üë• –ù–æ–≤—ñ | `funnel_monitor:{id}:new_users` |
| üîî –¢—Ä–∏–≥–µ—Ä–∏ | `funnel_monitor:{id}:triggers` |
| üìä –ó–≤—ñ—Ç | `funnel_monitor:{id}:report` |
| ‚óÄÔ∏è –î–æ –≤–æ—Ä–æ–Ω–∫–∏ | `funnel_view_{id}` |

### üîî –ú–µ–Ω—é —Ç—Ä–∏–≥–µ—Ä—ñ–≤
```
üîî –¢–†–ò–ì–ï–†–ò –í–û–†–û–ù–ö–ò #{id}

–¢–∏–ø–∏ —Ç—Ä–∏–≥–µ—Ä—ñ–≤:
‚îú üì© –ù–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
‚îú üëÜ –ù–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏
‚îú ‚è± –ü–æ —á–∞—Å—É (–∑–∞—Ç—Ä–∏–º–∫–∞)
‚îî üéØ –ù–∞ –∫–ª—é—á–æ–≤–µ —Å–ª–æ–≤–æ

–í–∏–±–µ—Ä—ñ—Ç—å –¥—ñ—é:
```

**–ö–Ω–æ–ø–∫–∏:**
| –ö–Ω–æ–ø–∫–∞ | Callback |
|--------|----------|
| ‚ûï –î–æ–¥–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä | `funnel_monitor:{id}:add_trigger` |
| üìã –ê–∫—Ç–∏–≤–Ω—ñ | `funnel_monitor:{id}:list_triggers` |
| ‚óÄÔ∏è –ù–∞–∑–∞–¥ | `funnel_monitor:{id}:menu` |

### üìä –ó–≤—ñ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
```
üìä –ó–í–Ü–¢ –ê–ö–¢–ò–í–ù–û–°–¢–Ü
{–Ω–∞–∑–≤–∞ –≤–æ—Ä–æ–Ω–∫–∏}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

–ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚îú –ö—Ä–æ–∫—ñ–≤: N
‚îú –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤: N
‚îú –ö–æ–Ω–≤–µ—Ä—Å—ñ–π: N
‚îî –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç: N%

–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞ 24 –≥–æ–¥–∏–Ω–∏:
‚îú –ù–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: N
‚îú –ó–∞–≤–µ—Ä—à–∏–ª–∏ –≤–æ—Ä–æ–Ω–∫—É: N
‚îî –í—ñ–¥–ø–∏—Å–∞–ª–∏—Å—å: N
```

---

## üóëÔ∏è –í–ò–î–ê–õ–ï–ù–ù–Ø –í–û–†–û–ù–ö–ò

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_delete_{id}`

### –ï–∫—Ä–∞–Ω –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
```
‚ö†Ô∏è –í–ò–î–ê–õ–ï–ù–ù–Ø –í–û–†–û–ù–ö–ò

–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ? –¶–µ –≤–∏–¥–∞–ª–∏—Ç—å –≤–æ—Ä–æ–Ω–∫—É —Ç–∞ –≤—Å—ñ —ó—ó –∫—Ä–æ–∫–∏!
```

### –ö–Ω–æ–ø–∫–∏
| –ö–Ω–æ–ø–∫–∞ | Callback |
|--------|----------|
| ‚úÖ –¢–∞–∫, –≤–∏–¥–∞–ª–∏—Ç–∏ | `funnel_delete_confirm_{id}` |
| ‚ùå –ù—ñ | `funnel_view_{id}` |

### –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–¥–∞–ª–µ–Ω–Ω—è
```
‚úÖ –í–æ—Ä–æ–Ω–∫—É —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ!

[–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–∞ —Å–ø–∏—Å–æ–∫ –≤–æ—Ä–æ–Ω–æ–∫]
```

---

## üîÑ –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ù–Ø –°–¢–ê–¢–£–°–£ (–°–¢–ê–†–¢/–°–¢–û–ü)

### –ö–æ–º–∞–Ω–¥–∞ –≤—Ö–æ–¥—É
- **Callback:** `funnel_toggle_{id}`
- **–î—ñ—è:** –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è `is_active`
  - –ê–∫—Ç–∏–≤–Ω–∞ ‚Üí –ù–µ–∞–∫—Ç–∏–≤–Ω–∞ (‚è∏ –°—Ç–æ–ø)
  - –ù–µ–∞–∫—Ç–∏–≤–Ω–∞ ‚Üí –ê–∫—Ç–∏–≤–Ω–∞ (‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç)

### –†–µ–∑—É–ª—å—Ç–∞—Ç
```
‚úÖ –°—Ç–∞—Ç—É—Å –≤–æ—Ä–æ–Ω–∫–∏ –∑–º—ñ–Ω–µ–Ω–æ: {–Ω–æ–≤_—Å—Ç–∞—Ç—É—Å}

[–ú–µ–Ω—é –≤–æ—Ä–æ–Ω–∫–∏ —ñ–∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏]
```

---

## üìã –¢–ê–ë–õ–ò–¶–Ø –í–°–Ü–• –ö–û–õ–õ–ë–ï–ö–Ü–í

| Callback | State | –î—ñ—è | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-------|-----|-----------|
| `funnels_main` | - | –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é | –°–ø–∏—Å–æ–∫ –≤–æ—Ä–æ–Ω–æ–∫ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| `funnel_create` | `waiting_name` | –°—Ç–≤–æ—Ä–µ–Ω–Ω—è | –ó–∞–ø–∏—Ç –Ω–∞ –Ω–∞–∑–≤—É |
| `funnel_view_{id}` | cleared | –î–µ—Ç–∞–ª—ñ | –û—Å–Ω–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏ |
| `funnel_edit_name_{id}` | `editing_name` | –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è | –ó–∞–ø–∏—Ç –Ω–∞ –Ω–æ–≤—É –Ω–∞–∑–≤—É |
| `funnel_edit_desc_{id}` | `editing_description` | –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è | –ó–∞–ø–∏—Ç –Ω–∞ –æ–ø–∏—Å |
| `funnel_edit_photo_{id}` | `editing_photo` | –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è | –ó–∞–ø–∏—Ç –Ω–∞ —Ñ–æ—Ç–æ |
| `funnel_remove_photo_{id}` | cleared | –í–∏–¥–∞–ª–µ–Ω–Ω—è | –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–æ—Ç–æ |
| `funnel_edit_config_{id}` | `editing_tariff` | –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è | –ó–∞–ø–∏—Ç –Ω–∞ –∫–æ–Ω—Ñ—ñ–≥ |
| `funnel_toggle_{id}` | - | Toggle | –ê–∫—Ç–∏–≤–∞—Ü—ñ—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è |
| `funnel_stats_{id}` | - | Stats | –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| `funnel_delete_{id}` | - | Confirm | –ó–∞–ø–∏—Ç –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è |
| `funnel_delete_confirm_{id}` | - | Delete | –í–∏–¥–∞–ª–µ–Ω–Ω—è |
| `funnel_steps_{id}` | cleared | List | –°–ø–∏—Å–æ–∫ –∫—Ä–æ–∫—ñ–≤ |
| `step_add_{id}` | `waiting_step_content` | Add | –ó–∞–ø–∏—Ç –Ω–∞ —Ç–µ–∫—Å—Ç |
| `step_view_{step_id}` | - | View | –î–µ—Ç–∞–ª—ñ –∫—Ä–æ–∫—É |
| `step_edit_content_{id}` | `editing_step_content` | Edit | –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è |
| `step_edit_title_{id}` | `editing_step_title` | Edit | –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞–∑–≤–∏ |
| `step_edit_photo_{id}` | `editing_step_photo` | Upload | –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ |
| `step_edit_delay_{id}` | `editing_step_delay` | Edit | –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–∫–∏ |
| `step_move_up_{id}` | - | Move | –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤–≤–µ—Ä—Ö |
| `step_move_down_{id}` | - | Move | –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –≤–Ω–∏–∑ |
| `step_delete_{id}` | - | Confirm | –ó–∞–ø–∏—Ç –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è |
| `funnel_mailing:{id}:*` | - | Menu | –ú–µ–Ω—é —Ä–æ–∑—Å–∏–ª–æ–∫ |
| `funnel_osint:{id}:*` | - | Menu | –ú–µ–Ω—é OSINT |
| `funnel_monitor:{id}:*` | - | Menu | –ú–µ–Ω—é –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É |
| `back_to_menu` | cleared | Return | –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è |

---

## üîê –ë–ï–ó–ü–ï–ö–ê

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø—É
```python
async def check_funnel_access(user_id: int) -> bool:
    if user_id in ADMIN_IDS:
        return True
    role = user_service.get_user_role(user_id)
    return role in [UserRole.LEADER, UserRole.ADMIN]
```

**–î–æ–∑–≤–æ–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø:** LEADER, ADMIN, –≤–∫–∞–∑–∞–Ω—ñ ADMIN_IDS

**–ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É:**
```
‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–æ—Ä–æ–Ω–∫–∞–º–∏
```

---

## üìê –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê FSM –°–¢–ê–ù–Ü–í

```
FunnelStates:
‚îú‚îÄ‚îÄ waiting_name                 # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–æ—Ä–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ waiting_description          # –û–ø–∏—Å (—è–∫—â–æ –¥–æ–¥–∞—î—Ç—å—Å—è)
‚îú‚îÄ‚îÄ waiting_photo               # –§–æ—Ç–æ (—è–∫—â–æ –¥–æ–¥–∞—î—Ç—å—Å—è)
‚îú‚îÄ‚îÄ waiting_welcome_text        # –í—ñ—Ç–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç
‚îú‚îÄ‚îÄ waiting_tariff_info         # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–∞—Ä–∏—Ñ
‚îú‚îÄ‚îÄ waiting_step_content        # –¢–µ–∫—Å—Ç –∫—Ä–æ–∫—É
‚îú‚îÄ‚îÄ waiting_step_title          # –ù–∞–∑–≤–∞ –∫—Ä–æ–∫—É
‚îú‚îÄ‚îÄ waiting_step_photo          # –§–æ—Ç–æ –∫—Ä–æ–∫—É
‚îú‚îÄ‚îÄ waiting_step_delay          # –ó–∞—Ç—Ä–∏–º–∫–∞ –∫—Ä–æ–∫—É
‚îú‚îÄ‚îÄ editing_name                # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞–∑–≤–∏
‚îú‚îÄ‚îÄ editing_description         # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –æ–ø–∏—Å—É
‚îú‚îÄ‚îÄ editing_photo              # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ–æ—Ç–æ
‚îú‚îÄ‚îÄ editing_tariff             # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É
‚îú‚îÄ‚îÄ editing_step_content       # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç –∫—Ä–æ–∫—É
‚îú‚îÄ‚îÄ editing_step_photo         # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ–æ—Ç–æ –∫—Ä–æ–∫—É
‚îî‚îÄ‚îÄ editing_step_title         # –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞–∑–≤–∏ –∫—Ä–æ–∫—É
```

---

## üé® –°–¢–ò–õ–Ü–ó–ê–¶–Ü–Ø –Ü–ù–¢–ï–†–§–ï–ô–°–£

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏
- **–†–æ–∑–¥—ñ–ª—é–≤–∞—á—ñ:** `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ` (15 —Å–∏–º–≤–æ–ª—ñ–≤)
- **–î–µ—Ä–µ–≤–æ:** `‚îú`, `‚îî`, `‚îÇ`
- **–°—Ç–∞—Ç—É—Å —ñ–∫–æ–Ω–∫–∏:** üü¢ –∞–∫—Ç–∏–≤–Ω–∞, ‚ö™ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
- **–¢–∏–ø–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É:** üìù —Ç–µ–∫—Å—Ç, üñº —Ñ–æ—Ç–æ
- **–§–æ—Ä–º–∞—Ç:** HTML (bold, italic, code, pre)

### –ü—Ä–∏–∫–ª–∞–¥ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è
```html
<b>üéØ –ù–ê–ó–í–ê –†–û–ó–î–Ü–õ–£</b>
<i>–ü—ñ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫</i>

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

<b>üìã –Ü–ù–§–û–†–ú–ê–¶–Ü–Ø:</b>
‚îú üìä –ü–æ–∫–∞–∑–Ω–∏–∫: <b>–∑–Ω–∞—á–µ–Ω–Ω—è</b>
‚îú üîî –û–ø–æ–≤—ñ—â–µ–Ω–Ω—è: —Ç–µ–∫—Å—Ç
‚îî üéØ –î—ñ—è: <code>callback</code>
```

---

## üìå –ö–Ü–õ–¨–ö–Ü–°–¢–¨ –û–ü–ï–†–ê–¶–Ü–ô

| –û–ø–µ—Ä–∞—Ü—ñ—è | –ö—ñ–ª—å–∫—ñ—Å—Ç—å |
|----------|-----------|
| –û—Å–Ω–æ–≤–Ω—ñ –º–µ–Ω—é | 3 |
| –ö–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–æ—Ä–æ–Ω–∫–æ—é | 7 |
| –ö–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫—Ä–æ–∫–∞–º–∏ | 7 |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π (Mailing/OSINT/Monitor) | 3 |
| FSM —Å—Ç–∞–Ω—ñ–≤ | 15 |
| –£—Å—å–æ–≥–æ –∫–æ–ª–ª–±–µ–∫—ñ–≤ | 40+ |
| –ü—Ä—è–º–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –æ–±—Ä–æ–±–∫–∏ | 25+ |

---

## ‚úÖ –í–ò–°–ù–û–í–û–ö

–°–∏—Å—Ç–µ–º–∞ –≤–æ—Ä–æ–Ω–æ–∫ SHADOW v2.0 –∑–∞–±–µ–∑–ø–µ—á—É—î:
- ‚úÖ **–ü–æ–≤–Ω–∞ CRUD** –¥–ª—è –≤–æ—Ä–æ–Ω–æ–∫ —Ç–∞ —ó—Ö –∫—Ä–æ–∫—ñ–≤
- ‚úÖ **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è** –∑ —Ä–æ–∑—Å–∏–ª–∫–∞–º–∏, OSINT —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥–æ–º
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ & –º–µ—Ç—Ä–∏–∫–∏** –∫–æ–Ω–≤–µ—Ä—Å—ñ–π
- ‚úÖ **FSM —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è** —Å—Ç–∞–Ω–∞–º–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
- ‚úÖ **–ë–µ–∑–ø–µ–∫–∞** –∑ RBAC –∫–æ–Ω—Ç—Ä–æ–ª–µ–º
- ‚úÖ **–ì–Ω—É—á–∫—ñ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ HTML —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è, —Ñ–æ—Ç–æ, –∑–∞—Ç—Ä–∏–º–æ–∫
- ‚úÖ **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥** —Ä–µ–∞–ª—Ç–∞–π–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ —Ç—Ä–∏–≥–µ—Ä—ñ–≤

**–ó–∞–≥–∞–ª—å–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Enterprise-level —Å–∏—Å—Ç–µ–º–∞ –∑ 40+ –∫–æ–º–∞–Ω–¥–∞–º–∏ —Ç–∞ –¥–µ—Ç–∞–ª–µ–≤–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –Ω–∞–¥ –∫–æ–∂–Ω–∏–º –∫—Ä–æ–∫–æ–º –≤–æ—Ä–æ–Ω–∫–∏.
